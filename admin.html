<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Admin Dashboard - Irie Development</title>
    <meta name="description" content="Admin dashboard for Irie Development">
    <meta name="theme-color" content="#007AFF">
    <link rel="stylesheet" href="style.css">
    <style>
        .admin-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        .admin-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .admin-header h1 {
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 50%, #FF2D92 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.5rem;
            margin-bottom: 1rem;
        }
        
        .admin-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
            margin-bottom: 3rem;
        }
        
        .admin-card {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .admin-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
            transition: left 0.5s;
        }
        
        .admin-card:hover::before {
            left: 100%;
        }
        
        .admin-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0, 122, 255, 0.2);
        }
        
        .admin-card h3 {
            color: var(--text-primary);
            font-size: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .admin-card p {
            color: var(--text-secondary);
            margin-bottom: 1.5rem;
            line-height: 1.6;
        }
        
        .admin-btn {
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }
        
        .admin-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }
        
        .admin-btn.newsletter {
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%);
        }
        
        .admin-btn.newsletter:hover {
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.3);
        }
        
        .admin-btn.analytics {
            background: linear-gradient(135deg, #FF9500 0%, #FF2D92 100%);
        }
        
        .admin-btn.analytics:hover {
            box-shadow: 0 8px 25px rgba(255, 149, 0, 0.3);
        }
        
        .admin-btn.settings {
            background: linear-gradient(135deg, #5856D6 0%, #AF52DE 100%);
        }
        
        .admin-btn.settings:hover {
            box-shadow: 0 8px 25px rgba(88, 86, 214, 0.3);
        }
        
        .back-btn {
            position: fixed;
            top: 20px;
            left: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: var(--text-primary);
            padding: 10px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
        }
        
        .back-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }
        
        /* Admin Login Styles */
        .admin-login {
            text-align: center;
            padding: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            margin: 20px;
            max-width: 500px;
            margin-left: auto;
            margin-right: auto;
            margin-top: 100px;
        }
        
        .admin-input {
            padding: 10px;
            margin: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
            background: rgba(255, 255, 255, 0.1);
            color: #ffffff;
            width: 300px;
        }
        
        .token-input {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .token-help {
            margin-top: 15px;
            padding: 10px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 6px;
            font-size: 14px;
        }
        
        .token-help a {
            color: #007AFF;
            text-decoration: none;
        }
        
        .token-help code {
            background: rgba(255, 255, 255, 0.1);
            padding: 2px 6px;
            border-radius: 3px;
            font-family: monospace;
        }
        
        .quick-actions-card {
            margin-top: 2rem;
        }
        
        .quick-actions-buttons {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 1rem;
        }
        
        /* Subscriber Management Modal */
        .subscriber-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            overflow-y: auto;
        }

        .subscriber-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .subscriber-modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            max-width: 900px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
        }

        .subscriber-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .subscriber-modal-header h2 {
            color: var(--text-primary);
            margin: 0;
        }

        .close-modal {
            background: rgba(255, 59, 48, 0.2);
            border: 1px solid rgba(255, 59, 48, 0.5);
            color: #FF3B30;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 1.5rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .close-modal:hover {
            background: rgba(255, 59, 48, 0.3);
            transform: scale(1.1);
        }

        .subscriber-list {
            margin-top: 1.5rem;
        }

        .subscriber-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem;
            margin-bottom: 0.75rem;
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            transition: all 0.3s ease;
        }

        .subscriber-item:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateX(5px);
        }

        .subscriber-email {
            color: var(--text-primary);
            font-size: 1rem;
            flex: 1;
            word-break: break-all;
        }

        .subscriber-actions {
            display: flex;
            gap: 0.5rem;
        }

        .btn-delete {
            background: linear-gradient(135deg, #FF3B30 0%, #FF2D55 100%);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.9rem;
        }

        .btn-delete:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 59, 48, 0.3);
        }

        .subscriber-stats {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }

        .stat-item {
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--text-primary);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-top: 0.5rem;
        }

        .loading-state {
            text-align: center;
            padding: 2rem;
            color: var(--text-secondary);
        }

        .empty-state {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
            display: none;
        }

        .empty-state-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
        }

        .hidden {
            display: none !important;
        }

        .notification-success {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #34C759;
            color: white;
            padding: 1rem;
            border-radius: 8px;
            z-index: 10000;
        }

        .refresh-btn-container {
            margin-bottom: 1rem;
        }

        .refresh-btn {
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 1rem;
        }

        .refresh-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }

        /* Export Modal Styles - Matching Subscriber Modal */
        .export-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 1000;
            overflow-y: auto;
        }

        .export-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 2rem;
        }

        .export-modal-content {
            background: var(--glass-bg);
            backdrop-filter: blur(20px);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            max-width: 700px;
            width: 100%;
            position: relative;
        }

        .export-modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
        }

        .export-modal-header h2 {
            color: var(--text-primary);
            margin: 0;
            font-size: 1.8rem;
        }

        .export-stats {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            text-align: center;
        }

        .export-stats-value {
            font-size: 2.5rem;
            font-weight: bold;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .export-stats-label {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .export-options {
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .export-option {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
            padding: 1.5rem;
            transition: all 0.3s ease;
        }

        .export-option:hover {
            background: rgba(255, 255, 255, 0.08);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.15);
        }

        .export-option-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 0.75rem;
        }

        .export-option-icon {
            font-size: 2rem;
        }

        .export-option-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--text-primary);
        }

        .export-option-desc {
            color: var(--text-secondary);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .export-btn {
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 10px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .export-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }

        .export-btn.csv {
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%);
        }

        .export-btn.csv:hover {
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.3);
        }

        .export-btn.json {
            background: linear-gradient(135deg, #FF9500 0%, #FF2D92 100%);
        }

        .export-btn.json:hover {
            box-shadow: 0 8px 25px rgba(255, 149, 0, 0.3);
        }

        /* App Form Styles */
        .app-form-container {
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .app-form-group {
            display: flex;
            flex-direction: column;
        }

        .app-form-label {
            display: block;
            margin-bottom: 0.5rem;
            color: var(--text-primary);
            font-weight: 600;
        }

        .app-form-input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.1);
            color: var(--text-primary);
            font-size: 1rem;
            box-sizing: border-box;
        }

        .app-form-input:focus {
            outline: none;
            border-color: #007AFF;
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .app-form-help {
            color: var(--text-secondary);
            font-size: 0.85rem;
            margin-top: 0.25rem;
            display: block;
        }

        .app-form-actions {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
        }

        .app-form-btn {
            flex: 1;
        }

        .app-form-btn-cancel {
            background: rgba(255, 59, 48, 0.2);
            color: #FF3B30;
            border: 1px solid rgba(255, 59, 48, 0.5);
        }

        .app-item-content {
            flex: 1;
            display: flex;
            align-items: center;
            gap: 1rem;
        }

        .app-item-icon {
            width: 50px;
            height: 50px;
            border-radius: 12px;
            object-fit: cover;
        }

        .app-item-info {
            flex: 1;
        }

        .app-item-title {
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.25rem;
        }

        .app-item-desc {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .app-item-link {
            color: #007AFF;
            font-size: 0.85rem;
            text-decoration: none;
        }

        .app-item-link:hover {
            text-decoration: underline;
        }

        .btn-edit {
            padding: 8px 16px;
            font-size: 0.9rem;
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
        }

        .btn-add-app {
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%);
        }

        .app-form-modal-content {
            max-width: 600px;
        }

        .analytics-empty {
            text-align: center;
            padding: 3rem;
            color: var(--text-secondary);
        }

        .analytics-empty-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }

        .analytics-empty-subtext {
            font-size: 0.9rem;
            margin-top: 0.5rem;
            opacity: 0.7;
        }

        .analytics-stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1.5rem;
            margin-bottom: 2rem;
        }

        .analytics-stat-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
        }

        .analytics-stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.08);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }

        .analytics-stat-icon {
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .analytics-stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: var(--text-primary);
            margin-bottom: 0.5rem;
        }

        .analytics-stat-label {
            font-size: 0.9rem;
            color: var(--text-secondary);
        }

        .analytics-section {
            margin-bottom: 2rem;
        }

        .analytics-section h3 {
            font-size: 1.3rem;
            margin-bottom: 1rem;
            color: var(--text-primary);
        }

        .analytics-chart-container {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
            min-height: 200px;
            margin-bottom: 1rem;
        }

        .simple-chart {
            display: flex;
            align-items: flex-end;
            justify-content: space-between;
            height: 150px;
            gap: 2px;
        }

        .simple-chart-bar {
            flex: 1;
            background: linear-gradient(180deg, #007AFF 0%, #5856D6 100%);
            border-radius: 4px 4px 0 0;
            min-height: 2px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .simple-chart-bar:hover {
            background: linear-gradient(180deg, #0051D5 0%, #4A3FB8 100%);
            transform: scaleY(1.05);
        }

        .analytics-note {
            font-size: 0.85rem;
            color: var(--text-secondary);
            text-align: center;
            margin-top: 0.5rem;
        }

        .analytics-activity-list {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            padding: 1.5rem;
        }

        .activity-item {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 1rem;
            border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        }

        .activity-item:last-child {
            border-bottom: none;
        }

        .activity-icon {
            font-size: 1.5rem;
        }

        .activity-details {
            flex: 1;
        }

        .activity-details strong {
            color: var(--text-primary);
            display: block;
            margin-bottom: 0.25rem;
        }

        .activity-timestamp {
            font-size: 0.85rem;
            color: var(--text-secondary);
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 1rem;
            }
            
            .admin-header h1 {
                font-size: 2rem;
            }
            
            .admin-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
            
            .back-btn {
                position: relative;
                top: auto;
                left: auto;
                margin-bottom: 2rem;
                display: inline-block;
            }

            .subscriber-modal.active,
            .export-modal.active {
                padding: 1rem;
            }

            .subscriber-modal-content,
            .export-modal-content {
                padding: 1.5rem;
            }

            .subscriber-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 1rem;
            }

            .subscriber-actions {
                width: 100%;
            }

            .btn-delete {
                width: 100%;
            }

            .export-option {
                padding: 1rem;
            }

            .export-option-header {
                flex-direction: column;
                align-items: flex-start;
                gap: 0.5rem;
            }

            .export-option-desc {
                margin-left: 0;
            }
        }

        /* Settings Modal Enhanced Styling */
        .settings-modal-content {
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
        }

        .settings-tabs {
            display: flex;
            gap: 0.75rem;
            margin: 0 -2rem 2.5rem -2rem;
            padding: 0 2rem 0 2rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .settings-tab {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 1rem 2rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            margin-bottom: -2px;
        }

        .settings-tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .settings-tab.active {
            color: var(--text-primary);
            border-bottom-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
        }

        .settings-tab-content {
            display: none;
        }

        .settings-tab-content.active {
            display: block;
        }

        .settings-section {
            margin-bottom: 3rem;
            padding: 2rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.08);
            transition: all 0.3s ease;
        }

        .settings-section:hover {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(255, 255, 255, 0.12);
        }

        .settings-section:last-child {
            margin-bottom: 0;
        }

        .settings-section h3 {
            color: var(--text-primary);
            font-size: 1.4rem;
            margin-bottom: 0.75rem;
            font-weight: 700;
        }

        .settings-description {
            color: var(--text-secondary);
            font-size: 0.95rem;
            margin-bottom: 2rem;
            line-height: 1.6;
        }

        .settings-form-group {
            margin-bottom: 2rem;
        }

        .settings-form-group:last-child {
            margin-bottom: 0;
        }

        .settings-label {
            display: block;
            color: var(--text-primary);
            font-weight: 600;
            margin-bottom: 0.75rem;
            font-size: 1rem;
        }

        .settings-input-group {
            display: flex;
            gap: 0.75rem;
            align-items: stretch;
        }

        .settings-input,
        .settings-textarea {
            flex: 1;
            width: 100%;
            padding: 1rem 1.25rem;
            background: rgba(255, 255, 255, 0.06);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .settings-input::placeholder,
        .settings-textarea::placeholder {
            color: var(--text-secondary);
            opacity: 0.6;
        }

        .settings-input:focus,
        .settings-textarea:focus {
            outline: none;
            border-color: #007AFF;
            background: rgba(255, 255, 255, 0.1);
            box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
        }

        .settings-textarea {
            resize: vertical;
            min-height: 80px;
        }

        .settings-toggle-visibility {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid rgba(255, 255, 255, 0.12);
            border-radius: 12px;
            padding: 1rem 1.25rem;
            color: var(--text-primary);
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.1rem;
            min-width: 60px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .settings-toggle-visibility:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.2);
            transform: scale(1.05);
        }

        .settings-help {
            display: block;
            color: var(--text-secondary);
            font-size: 0.875rem;
            margin-top: 0.75rem;
            line-height: 1.5;
        }

        .settings-help a {
            color: #007AFF;
            text-decoration: none;
        }

        .settings-help a:hover {
            text-decoration: underline;
        }

        .settings-help.danger {
            color: #FF3B30;
        }

        .settings-test-btn {
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%);
            color: white;
            border: none;
            padding: 1rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
            width: 100%;
        }

        .settings-test-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.3);
        }

        .settings-test-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .settings-checkbox-group {
            margin-bottom: 1.25rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.03);
            border-radius: 10px;
            transition: all 0.3s ease;
        }

        .settings-checkbox-group:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .settings-checkbox-label {
            display: flex;
            align-items: center;
            gap: 1rem;
            color: var(--text-primary);
            cursor: pointer;
            font-size: 1rem;
        }

        .settings-checkbox {
            width: 22px;
            height: 22px;
            cursor: pointer;
            accent-color: #007AFF;
        }

        .settings-backup-actions {
            display: flex;
            gap: 1rem;
            margin-bottom: 2.5rem;
        }

        .settings-backup-btn {
            flex: 1;
            background: linear-gradient(135deg, #007AFF 0%, #5856D6 100%);
            color: white;
            border: none;
            padding: 1.25rem 1.5rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-backup-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 122, 255, 0.3);
        }

        .settings-danger-btn {
            background: linear-gradient(135deg, #FF3B30 0%, #FF2D55 100%);
            color: white;
            border: none;
            padding: 1.25rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 1.5rem;
            width: 100%;
        }

        .settings-danger-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(255, 59, 48, 0.3);
        }

        .settings-actions {
            display: flex;
            gap: 1rem;
            margin: 3rem -2rem -2rem -2rem;
            padding: 2rem;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
            position: sticky;
            bottom: 0;
        }

        .settings-save-btn {
            flex: 1;
            background: linear-gradient(135deg, #34C759 0%, #30D158 100%);
            color: white;
            border: none;
            padding: 1.25rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-save-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(52, 199, 89, 0.3);
        }

        .settings-cancel-btn {
            flex: 1;
            background: rgba(255, 255, 255, 0.08);
            color: var(--text-primary);
            border: 1px solid rgba(255, 255, 255, 0.15);
            padding: 1.25rem 2rem;
            border-radius: 12px;
            font-weight: 600;
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-cancel-btn:hover {
            background: rgba(255, 255, 255, 0.12);
            border-color: rgba(255, 255, 255, 0.25);
        }

        @media (max-width: 768px) {
            .settings-modal-content {
                padding: 1.5rem;
            }

            .settings-tabs {
                margin: 0 -1.5rem 2rem -1.5rem;
                padding: 0 1.5rem;
                flex-wrap: wrap;
            }

            .settings-tab {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }

            .settings-section {
                padding: 1.5rem;
            }

            .settings-actions {
                margin: 2rem -1.5rem -1.5rem -1.5rem;
                padding: 1.5rem;
                flex-direction: column;
            }

            .settings-backup-actions {
                flex-direction: column;
            }
        }

        /* Content Editor Styles */
        .content-editor-modal-content {
            max-width: 900px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 2rem;
        }

        .content-editor-tabs {
            display: flex;
            gap: 0.75rem;
            margin: 0 -2rem 2.5rem -2rem;
            padding: 0 2rem;
            border-bottom: 2px solid rgba(255, 255, 255, 0.1);
            background: rgba(255, 255, 255, 0.02);
        }

        .content-editor-tab {
            background: transparent;
            border: none;
            color: var(--text-secondary);
            padding: 1rem 2rem;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s ease;
            position: relative;
            margin-bottom: -2px;
        }

        .content-editor-tab:hover {
            color: var(--text-primary);
            background: rgba(255, 255, 255, 0.05);
        }

        .content-editor-tab.active {
            color: var(--text-primary);
            border-bottom-color: #007AFF;
            background: rgba(0, 122, 255, 0.1);
        }

        .content-editor-tab-content {
            display: none;
        }

        .content-editor-tab-content.active {
            display: block;
        }

        @media (max-width: 768px) {
            .content-editor-modal-content {
                padding: 1.5rem;
            }

            .content-editor-tabs {
                margin: 0 -1.5rem 2rem -1.5rem;
                padding: 0 1.5rem;
                flex-wrap: wrap;
            }

            .content-editor-tab {
                padding: 0.75rem 1rem;
                font-size: 0.9rem;
            }
        }
    </style>
</head>
<body>
    <!-- Admin Login Form -->
    <div id="loginSection" class="admin-login">
        <h3>üîí Admin Access Required</h3>
        <p>Enter your GitHub Personal Access Token to access the admin dashboard:</p>
        <div class="token-input">
            <input type="password" id="githubToken" placeholder="Enter GitHub Personal Access Token" class="admin-input">
            <button type="button" onclick="verifyGitHubToken()" class="admin-btn">Verify Token</button>
        </div>
        <div class="token-help">
            <p><small>üí° Create a token at: <a href="https://github.com/settings/tokens" target="_blank">GitHub Settings &gt; Developer settings &gt; Personal access tokens</a></small></p>
            <p><small>üîë Token needs: <code>read:user</code> scope</small></p>
        </div>
    </div>

    <!-- Admin Dashboard (Hidden by default) -->
    <div id="adminSection" class="admin-container" style="display: none;">
        <a href="index.html" class="back-btn">‚Üê Back to Site</a>

        <div class="admin-header">
            <h1>üîß Admin Dashboard</h1>
            <p>Manage your Irie Development website and applications</p>
        </div>

        <div class="admin-grid">
            <div class="admin-card">
                <h3>üìß Newsletter Management</h3>
                <p>Send newsletters to your subscribers, manage subscriber list, and view analytics.</p>
                <a href="send_newsletter.html" class="admin-btn newsletter">Manage Newsletter</a>
            </div>

            <div class="admin-card">
                <h3>üë• Subscriber Management</h3>
                <p>View all subscribers, remove individual subscribers, and manage your subscriber list.</p>
                <button type="button" onclick="openSubscriberManager()" class="admin-btn newsletter">Manage Subscribers</button>
            </div>

            <div class="admin-card">
                <h3>üìä Analytics</h3>
                <p>View website analytics, subscriber growth, and newsletter performance metrics.</p>
                <button type="button" class="admin-btn analytics" onclick="openAnalytics()">View Analytics</button>
            </div>

            <div class="admin-card">
                <h3>‚öôÔ∏è Settings</h3>
                <p>Configure website settings, update content, and manage admin preferences.</p>
                <button type="button" class="admin-btn settings" onclick="openSettings()">Manage Settings</button>
            </div>

            <div class="admin-card">
                <h3>üì± App Management</h3>
                <p>Update app information, add new apps, and manage App Store links.</p>
                <button type="button" class="admin-btn" onclick="openAppManager()">Manage Apps</button>
            </div>

            <div class="admin-card">
                <h3>üìÑ Content Editor</h3>
                <p>Edit website content, update pages, and manage SEO settings.</p>
                <button type="button" class="admin-btn" onclick="openContentEditor()">Edit Content</button>
            </div>
        </div>

        <div class="admin-card quick-actions-card">
            <h3>üöÄ Quick Actions</h3>
            <p>Quick access to frequently used admin functions.</p>
            <div class="quick-actions-buttons">
                <a href="send_newsletter.html" class="admin-btn newsletter">Send Newsletter</a>
                <a href="index.html" class="admin-btn">View Site</a>
                <button type="button" class="admin-btn" onclick="openExportModal()">üì• Export Data</button>
            </div>
        </div>
    </div>

    <!-- Export Data Modal -->
    <div id="exportModal" class="export-modal">
        <div class="export-modal-content">
            <div class="export-modal-header">
                <h2>üì• Export Data</h2>
                <button type="button" class="close-modal" onclick="closeExportModal()" aria-label="Close">&times;</button>
            </div>

            <div class="export-stats" id="exportStats">
                <div class="export-stats-value" id="exportSubscriberCount">‚Äî</div>
                <div class="export-stats-label">Subscribers Available</div>
            </div>

            <div class="export-options">
                <div class="export-option">
                    <div class="export-option-header">
                        <span class="export-option-icon">üìä</span>
                        <span class="export-option-title">Export as CSV</span>
                    </div>
                    <p class="export-option-desc">Comma-separated values format. Perfect for Excel, Google Sheets, and data analysis.</p>
                    <button type="button" class="export-btn csv" onclick="exportSubscribers('csv')">
                        üì• Download CSV
                    </button>
                </div>

                <div class="export-option">
                    <div class="export-option-header">
                        <span class="export-option-icon">üìÑ</span>
                        <span class="export-option-title">Export as JSON</span>
                    </div>
                    <p class="export-option-desc">JavaScript Object Notation format. Perfect for backups and programmatic use.</p>
                    <button type="button" class="export-btn json" onclick="exportSubscribers('json')">
                        üì• Download JSON
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- App Management Modal -->
    <div id="appModal" class="subscriber-modal">
        <div class="subscriber-modal-content">
            <div class="subscriber-modal-header">
                <h2>üì± App Management</h2>
                <button type="button" class="close-modal" onclick="closeAppManager()" aria-label="Close">&times;</button>
            </div>

            <div class="subscriber-stats hidden" id="appStats">
                <div class="stat-item">
                    <div class="stat-value" id="totalApps">0</div>
                    <div class="stat-label">Total Apps</div>
                </div>
            </div>

            <div class="refresh-btn-container">
                <button type="button" onclick="loadApps()" class="refresh-btn" id="refreshAppsBtn">
                    üîÑ Refresh List
                </button>
                <button type="button" onclick="openAddAppForm()" class="refresh-btn btn-add-app">
                    ‚ûï Add New App
                </button>
            </div>

            <div id="appListContainer">
                <div class="loading-state" id="appLoadingState">
                    <p>‚è≥ Loading apps...</p>
                </div>
                <div class="subscriber-list hidden" id="appList"></div>
                <div class="empty-state hidden" id="appEmptyState">
                    <div class="empty-state-icon">üì±</div>
                    <p>No apps found. Add your first app!</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit App Form Modal -->
    <div id="appFormModal" class="subscriber-modal">
        <div class="subscriber-modal-content app-form-modal-content">
            <div class="subscriber-modal-header">
                <h2 id="appFormTitle">‚ûï Add New App</h2>
                <button type="button" class="close-modal" onclick="closeAppForm()" aria-label="Close">&times;</button>
            </div>

            <form id="appForm" onsubmit="saveApp(event)">
                <div class="app-form-container">
                    <div class="app-form-group">
                        <label for="appTitle" class="app-form-label">App Title:</label>
                        <input type="text" id="appTitle" required class="app-form-input" placeholder="e.g., Sudoku Mindscape - Basic">
                    </div>

                    <div class="app-form-group">
                        <label for="appDesc" class="app-form-label">Category/Description:</label>
                        <input type="text" id="appDesc" required class="app-form-input" placeholder="e.g., Puzzle, Travel, Education">
                    </div>

                    <div class="app-form-group">
                        <label for="appUrl" class="app-form-label">App Store URL:</label>
                        <input type="url" id="appUrl" required class="app-form-input" placeholder="https://apps.apple.com/us/app/...">
                    </div>

                    <div class="app-form-group">
                        <label for="appIcon" class="app-form-label">App Icon URL:</label>
                        <input type="url" id="appIcon" required class="app-form-input" placeholder="https://is1-ssl.mzstatic.com/image/thumb/...">
                        <small class="app-form-help">Image URL from App Store or your hosting</small>
                    </div>

                    <div class="app-form-actions">
                        <button type="submit" class="refresh-btn app-form-btn">
                            üíæ Save App
                        </button>
                        <button type="button" onclick="closeAppForm()" class="refresh-btn app-form-btn app-form-btn-cancel">
                            Cancel
                        </button>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Analytics Dashboard Modal -->
    <div id="analyticsModal" class="subscriber-modal">
        <div class="subscriber-modal-content analytics-modal-content">
            <div class="subscriber-modal-header">
                <h2>üìä Analytics Dashboard</h2>
                <button type="button" class="close-modal" onclick="closeAnalytics()" aria-label="Close">&times;</button>
            </div>

            <div class="analytics-stats-grid" id="analyticsStatsGrid">
                <div class="analytics-stat-card">
                    <div class="analytics-stat-icon">üë•</div>
                    <div class="analytics-stat-value" id="totalSubscribersStat">‚Äî</div>
                    <div class="analytics-stat-label">Total Subscribers</div>
                </div>
                <div class="analytics-stat-card">
                    <div class="analytics-stat-icon">üìà</div>
                    <div class="analytics-stat-value" id="growthRateStat">‚Äî</div>
                    <div class="analytics-stat-label">Growth Rate</div>
                </div>
                <div class="analytics-stat-card">
                    <div class="analytics-stat-icon">üì±</div>
                    <div class="analytics-stat-value" id="totalAppsStat">‚Äî</div>
                    <div class="analytics-stat-label">Total Apps</div>
                </div>
                <div class="analytics-stat-card">
                    <div class="analytics-stat-icon">üìß</div>
                    <div class="analytics-stat-value" id="newsletterSendsStat">‚Äî</div>
                    <div class="analytics-stat-label">Newsletters Sent</div>
                </div>
            </div>

            <div class="analytics-section">
                <h3>üìà Subscriber Growth</h3>
                <div class="analytics-chart-container">
                    <div id="subscriberGrowthChart" class="simple-chart">
                        <div class="analytics-empty">Loading chart data...</div>
                    </div>
                </div>
                <p class="analytics-note">Subscriber count over time (last 30 days)</p>
            </div>

            <div class="refresh-btn-container">
                <button type="button" onclick="loadAnalytics()" class="refresh-btn" id="refreshAnalyticsBtn">
                    üîÑ Refresh Analytics
                </button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="subscriber-modal">
        <div class="subscriber-modal-content settings-modal-content">
            <div class="subscriber-modal-header">
                <h2>‚öôÔ∏è Settings &amp; Configuration</h2>
                <button type="button" class="close-modal" onclick="closeSettings()" aria-label="Close">&times;</button>
            </div>

            <div class="settings-tabs">
                <button type="button" class="settings-tab active" onclick="switchSettingsTab('api')">üîë API Keys</button>
                <button type="button" class="settings-tab" onclick="switchSettingsTab('preferences')">‚öôÔ∏è Preferences</button>
                <button type="button" class="settings-tab" onclick="switchSettingsTab('backup')">üíæ Backup</button>
            </div>

            <!-- API Keys Tab -->
            <div id="settingsApiTab" class="settings-tab-content active">
                <div class="settings-section">
                    <h3>üîê JSONBin.io Configuration</h3>
                    <p class="settings-description">Manage your JSONBin.io API keys for cloud storage.</p>

                    <div class="settings-form-group">
                        <label for="jsonbinAccessKey" class="settings-label">Access Key:</label>
                        <div class="settings-input-group">
                            <input type="password" id="jsonbinAccessKey" class="settings-input" placeholder="Enter JSONBin Access Key">
                            <button type="button" class="settings-toggle-visibility" onclick="togglePasswordVisibility('jsonbinAccessKey', this)" title="Show/Hide">üëÅÔ∏è</button>
                        </div>
                        <small class="settings-help">Used for secure cloud storage access. Get it from <a href="https://jsonbin.io/app/account/api-keys" target="_blank">JSONBin.io</a></small>
                    </div>

                    <div class="settings-form-group">
                        <label for="jsonbinBinId" class="settings-label">Subscriber Bin ID:</label>
                        <input type="text" id="jsonbinBinId" class="settings-input" placeholder="Auto-generated or enter manually">
                        <small class="settings-help">The bin ID where subscriber data is stored</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="jsonbinAppsBinId" class="settings-label">Apps Bin ID:</label>
                        <input type="text" id="jsonbinAppsBinId" class="settings-input" placeholder="Auto-generated or enter manually">
                        <small class="settings-help">The bin ID where app data is stored</small>
                    </div>

                    <button type="button" class="settings-test-btn" onclick="testJSONBinConnection()">
                        üîç Test Connection
                    </button>
                </div>

                <div class="settings-section">
                    <h3>üìß EmailJS Configuration</h3>
                    <p class="settings-description">Manage your EmailJS service for sending newsletters.</p>

                    <div class="settings-form-group">
                        <label for="emailjsServiceId" class="settings-label">Service ID:</label>
                        <input type="text" id="emailjsServiceId" class="settings-input" placeholder="service_xxxxx">
                        <small class="settings-help">Your EmailJS service ID</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="emailjsTemplateId" class="settings-label">Template ID:</label>
                        <input type="text" id="emailjsTemplateId" class="settings-input" placeholder="template_xxxxx">
                        <small class="settings-help">Template for subscription confirmations</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="emailjsNewsletterTemplateId" class="settings-label">Newsletter Template ID:</label>
                        <input type="text" id="emailjsNewsletterTemplateId" class="settings-input" placeholder="template_xxxxx">
                        <small class="settings-help">Template for sending newsletters</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="emailjsUserId" class="settings-label">User ID (Public Key):</label>
                        <input type="text" id="emailjsUserId" class="settings-input" placeholder="xxxxx">
                        <small class="settings-help">Your EmailJS public key</small>
                    </div>
                </div>
            </div>

            <!-- Preferences Tab -->
            <div id="settingsPreferencesTab" class="settings-tab-content">
                <div class="settings-section">
                    <h3>üåê Website Preferences</h3>

                    <div class="settings-form-group">
                        <label for="websiteName" class="settings-label">Website Name:</label>
                        <input type="text" id="websiteName" class="settings-input" placeholder="Irie Development">
                        <small class="settings-help">Display name for your website</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="websiteDescription" class="settings-label">Website Description:</label>
                        <textarea id="websiteDescription" class="settings-textarea" rows="3" placeholder="Description for SEO and social sharing"></textarea>
                        <small class="settings-help">Meta description for search engines</small>
                    </div>

                </div>
            </div>

            <!-- Backup Tab -->
            <div id="settingsBackupTab" class="settings-tab-content">
                <div class="settings-section">
                    <h3>üíæ Backup &amp; Restore</h3>
                    <p class="settings-description">Backup your settings and restore from a previous backup.</p>

                    <div class="settings-backup-actions">
                        <button type="button" class="settings-backup-btn" onclick="exportSettings()">
                            üì• Export Settings
                        </button>
                        <button type="button" class="settings-backup-btn" onclick="document.getElementById('settingsFileInput').click()">
                            üì§ Import Settings
                        </button>
                        <input type="file" id="settingsFileInput" accept=".json" style="display: none;" onchange="importSettings(event)">
                    </div>

                    <div class="settings-section">
                        <h3>üóëÔ∏è Danger Zone</h3>
                        <p class="settings-description">Irreversible actions. Use with caution.</p>

                        <button type="button" class="settings-danger-btn" onclick="clearAllData()">
                            üóëÔ∏è Clear All Data
                        </button>
                        <small class="settings-help danger">This will delete all subscribers, apps, and settings. This action cannot be undone.</small>
                    </div>
                </div>
            </div>

            <div class="settings-actions">
                <button type="button" class="settings-save-btn" onclick="saveSettings()">
                    üíæ Save Settings
                </button>
                <button type="button" class="settings-cancel-btn" onclick="closeSettings()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Content Editor Modal -->
    <div id="contentEditorModal" class="subscriber-modal">
        <div class="subscriber-modal-content content-editor-modal-content">
            <div class="subscriber-modal-header">
                <h2>üìÑ Content Editor</h2>
                <button type="button" class="close-modal" onclick="closeContentEditor()" aria-label="Close">&times;</button>
            </div>

            <div class="content-editor-tabs">
                <button type="button" class="content-editor-tab active" onclick="switchContentTab('seo')">üîç SEO Settings</button>
                <button type="button" class="content-editor-tab" onclick="switchContentTab('pages')">üìÑ Pages</button>
            </div>

            <!-- SEO Settings Tab -->
            <div id="contentSeoTab" class="content-editor-tab-content active">
                <div class="settings-section">
                    <h3>üåê Homepage (index.html) SEO</h3>
                    <p class="settings-description">Manage SEO metadata for your main homepage.</p>

                    <div class="settings-form-group">
                        <label for="seoPageTitle" class="settings-label">Page Title:</label>
                        <input type="text" id="seoPageTitle" class="settings-input" placeholder="Irie Development | iOS App Developer & Arkansas Apps">
                        <small class="settings-help">Appears in browser tabs and search results (50-60 characters recommended)</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoMetaDescription" class="settings-label">Meta Description:</label>
                        <textarea id="seoMetaDescription" class="settings-textarea" rows="3" placeholder="Irie Development creates innovative iOS apps..."></textarea>
                        <small class="settings-help">Appears in search results (150-160 characters recommended)</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoKeywords" class="settings-label">Keywords:</label>
                        <input type="text" id="seoKeywords" class="settings-input" placeholder="iOS developer, iPhone apps, iPad apps...">
                        <small class="settings-help">Comma-separated keywords for SEO</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoOgTitle" class="settings-label">Open Graph Title (Social Sharing):</label>
                        <input type="text" id="seoOgTitle" class="settings-input" placeholder="Irie Development | iOS App Developer & Arkansas Apps">
                        <small class="settings-help">Title shown when sharing on Facebook, LinkedIn, etc.</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoOgDescription" class="settings-label">Open Graph Description:</label>
                        <textarea id="seoOgDescription" class="settings-textarea" rows="2" placeholder="Innovative iOS apps for iPhone, iPad, and Apple Watch..."></textarea>
                        <small class="settings-help">Description shown when sharing on social media</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoOgImage" class="settings-label">Open Graph Image URL:</label>
                        <input type="url" id="seoOgImage" class="settings-input" placeholder="https://iriedevelopment.com/og-image.jpg">
                        <small class="settings-help">Image shown when sharing (1200x630px recommended)</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoTwitterTitle" class="settings-label">Twitter Card Title:</label>
                        <input type="text" id="seoTwitterTitle" class="settings-input" placeholder="Irie Development | iOS App Developer & Arkansas Apps">
                        <small class="settings-help">Title for Twitter sharing</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="seoTwitterDescription" class="settings-label">Twitter Card Description:</label>
                        <textarea id="seoTwitterDescription" class="settings-textarea" rows="2" placeholder="Innovative iOS apps for iPhone, iPad, and Apple Watch..."></textarea>
                        <small class="settings-help">Description for Twitter sharing</small>
                    </div>
                </div>
            </div>

            <!-- Pages Tab -->
            <div id="contentPagesTab" class="content-editor-tab-content">
                <div class="settings-section">
                    <h3>üìÑ Page Content</h3>
                    <p class="settings-description">Edit content for your website pages.</p>

                    <div class="settings-form-group">
                        <label for="contentPageSelect" class="settings-label">Select Page:</label>
                        <select id="contentPageSelect" class="settings-input" onchange="loadPageContent()">
                            <option value="index.html">Homepage (index.html)</option>
                            <option value="pages/privacy_policies/privacy.html">Privacy Policy</option>
                            <option value="pages/terms_of_service/terms.html">Terms of Service</option>
                        </select>
                    </div>

                    <div class="settings-form-group">
                        <label for="contentMainHeading" class="settings-label">Main Heading (H1):</label>
                        <input type="text" id="contentMainHeading" class="settings-input" placeholder="Welcome to Irie Development">
                        <small class="settings-help">Main page heading</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="contentAboutText" class="settings-label">About Section:</label>
                        <textarea id="contentAboutText" class="settings-textarea" rows="5" placeholder="About your company..."></textarea>
                        <small class="settings-help">Main about/description text</small>
                    </div>

                    <div class="settings-form-group">
                        <label for="contentNewsletterText" class="settings-label">Newsletter Section Text:</label>
                        <textarea id="contentNewsletterText" class="settings-textarea" rows="3" placeholder="Stay updated with our latest apps..."></textarea>
                        <small class="settings-help">Text above the newsletter signup form</small>
                    </div>
                </div>
            </div>

            <div class="settings-actions">
                <button type="button" class="settings-save-btn" onclick="exportContentChanges()">
                    üì• Export Changes
                </button>
                <button type="button" class="settings-cancel-btn" onclick="closeContentEditor()">
                    Cancel
                </button>
            </div>
        </div>
    </div>

    <!-- Subscriber Management Modal -->
    <div id="subscriberModal" class="subscriber-modal">
        <div class="subscriber-modal-content">
            <div class="subscriber-modal-header">
                <h2>üë• Subscriber Management</h2>
                <button type="button" class="close-modal" onclick="closeSubscriberManager()" aria-label="Close">&times;</button>
            </div>

            <div class="subscriber-stats hidden" id="subscriberStats">
                <div class="stat-item">
                    <div class="stat-value" id="totalSubscribers">0</div>
                    <div class="stat-label">Total Subscribers</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="displayedSubscribers">0</div>
                    <div class="stat-label">Displayed</div>
                </div>
            </div>

            <div class="refresh-btn-container">
                <button type="button" onclick="loadSubscribers()" class="refresh-btn" id="refreshSubscribersBtn">
                    üîÑ Refresh List
                </button>
            </div>

            <div id="subscriberListContainer">
                <div class="loading-state" id="loadingState">
                    <p>‚è≥ Loading subscribers...</p>
                </div>
                <div class="subscriber-list hidden" id="subscriberList"></div>
                <div class="empty-state hidden" id="emptyState">
                    <div class="empty-state-icon">üì≠</div>
                    <p>No subscribers found</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // GitHub Authentication configuration
        const GITHUB_CONFIG = {
            allowedUsers: ['iriecoffelt']
        };
        
        // GitHub Personal Access Token verification
        async function verifyGitHubToken() {
            const token = document.getElementById('githubToken').value.trim();
            
            if (!token) {
                alert('‚ùå Please enter a GitHub Personal Access Token.');
                return;
            }
            
            try {
                const response = await fetch('https://api.github.com/user', {
                    headers: {
                        'Authorization': `token ${token}`,
                        'Accept': 'application/vnd.github.v3+json',
                        'User-Agent': 'Irie-Development-Admin'
                    }
                });
                
                if (response.ok) {
                    const user = await response.json();
                    console.log('GitHub user:', user);
                    
                    if (GITHUB_CONFIG.allowedUsers.includes(user.login)) {
                        // Authorized user
                        document.getElementById('loginSection').style.display = 'none';
                        document.getElementById('adminSection').style.display = 'block';
                        
                        // Store token securely (sessionStorage for this session only)
                        sessionStorage.setItem('github_token', token);
                        sessionStorage.setItem('github_user', user.login);
                        
                        alert(`‚úÖ Welcome, ${user.login}! Access granted.`);
                    } else {
                        alert('‚ùå Access denied. Only authorized users can access this page.');
                        document.getElementById('githubToken').value = '';
                    }
                } else {
                    alert('‚ùå Invalid token. Please check your GitHub Personal Access Token.');
                    document.getElementById('githubToken').value = '';
                }
            } catch (error) {
                console.error('GitHub API error:', error);
                alert('‚ùå Error verifying token. Please try again.');
                document.getElementById('githubToken').value = '';
            }
        }
        
        // Check if user is already authenticated
        function checkGitHubAuth() {
            const token = sessionStorage.getItem('github_token');
            const user = sessionStorage.getItem('github_user');
            
            if (token && user && GITHUB_CONFIG.allowedUsers.includes(user)) {
                // User is already authenticated
                document.getElementById('loginSection').style.display = 'none';
                document.getElementById('adminSection').style.display = 'block';
            }
        }
        
        // Subscriber Management Functions
        function openSubscriberManager() {
            const modal = document.getElementById('subscriberModal');
            modal.classList.add('active');
            loadSubscribers();
        }

        function closeSubscriberManager() {
            const modal = document.getElementById('subscriberModal');
            modal.classList.remove('active');
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('subscriberModal');
            if (e.target === modal) {
                closeSubscriberManager();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeSubscriberManager();
            }
        });

        // Load and display subscribers
        async function loadSubscribers() {
            const loadingState = document.getElementById('loadingState');
            const subscriberList = document.getElementById('subscriberList');
            const emptyState = document.getElementById('emptyState');
            const subscriberStats = document.getElementById('subscriberStats');
            const refreshBtn = document.getElementById('refreshSubscribersBtn');

            // Show loading state
            loadingState.classList.remove('hidden');
            subscriberList.classList.add('hidden');
            emptyState.classList.add('hidden');
            subscriberStats.classList.add('hidden');
            refreshBtn.disabled = true;
            refreshBtn.textContent = '‚è≥ Loading...';

            try {
                // Wait for newsletter manager to be available
                if (typeof newsletterManager === 'undefined') {
                    // Wait a bit for the script to load
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                let subscribers = [];

                // Try to get subscribers from newsletter manager
                if (typeof newsletterManager !== 'undefined') {
                    await newsletterManager.loadSubscribers();
                    subscribers = newsletterManager.subscribers || [];
                } else {
                    // Fallback: fetch from JSONBin directly
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            },
                            cache: 'no-store'
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            subscribers = data.subscribers || [];
                        }
                    }

                    // Final fallback: local file
                    if (subscribers.length === 0) {
                        const response = await fetch('/data/subscribers.json', {
                            cache: 'no-store'
                        });
                        if (response.ok) {
                            subscribers = await response.json();
                        }
                    }
                }

                // Update stats
                document.getElementById('totalSubscribers').textContent = subscribers.length.toLocaleString();
                document.getElementById('displayedSubscribers').textContent = subscribers.length.toLocaleString();
                subscriberStats.classList.remove('hidden');
                subscriberStats.style.display = 'flex';

                // Display subscribers
                if (subscribers.length === 0) {
                    loadingState.classList.add('hidden');
                    emptyState.classList.remove('hidden');
                } else {
                    displaySubscribers(subscribers);
                    loadingState.classList.add('hidden');
                    subscriberList.classList.remove('hidden');
                }

            } catch (error) {
                console.error('Error loading subscribers:', error);
                loadingState.innerHTML = '<p style="color: #FF3B30;">‚ùå Error loading subscribers. Check console for details.</p>';
            } finally {
                refreshBtn.disabled = false;
                refreshBtn.textContent = 'üîÑ Refresh List';
            }
        }

        // Display subscribers in the list
        function displaySubscribers(subscribers) {
            const subscriberList = document.getElementById('subscriberList');
            subscriberList.innerHTML = '';

            subscribers.forEach((email, index) => {
                const item = document.createElement('div');
                item.className = 'subscriber-item';
                item.innerHTML = `
                    <span class="subscriber-email">${email}</span>
                    <div class="subscriber-actions">
                        <button type="button" class="btn-delete" onclick="deleteSubscriber('${email}', ${index})" title="Delete subscriber">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                subscriberList.appendChild(item);
            });
        }

        // Delete a subscriber
        async function deleteSubscriber(email, index) {
            if (!confirm(`Are you sure you want to remove ${email} from the subscriber list?`)) {
                return;
            }

            try {
                // Remove from newsletter manager if available
                if (typeof newsletterManager !== 'undefined') {
                    await newsletterManager.removeSubscriber(email);
                } else {
                    // Fallback: manual removal
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        
                        // Fetch current data
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            }
                        });
                        
                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            let subscribers = data.subscribers || [];
                            
                            // Remove the email
                            subscribers = subscribers.filter(e => e !== email);
                            
                            // Update JSONBin
                            const updateResponse = await fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
                                method: 'PUT',
                                headers: {
                                    'Content-Type': 'application/json',
                                    'X-Access-Key': accessKey
                                },
                                body: JSON.stringify({
                                    subscribers: subscribers,
                                    lastUpdated: new Date().toISOString(),
                                    count: subscribers.length
                                })
                            });
                            
                            if (!updateResponse.ok) {
                                throw new Error('Failed to update JSONBin');
                            }
                        }
                    }
                }

                // Reload the list
                await loadSubscribers();
                
                // Show success message
                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = `‚úÖ ${email} removed successfully`;
                document.body.appendChild(notification);
                
                setTimeout(() => {
                    notification.remove();
                }, 3000);

            } catch (error) {
                console.error('Error deleting subscriber:', error);
                alert('‚ùå Failed to delete subscriber: ' + error.message);
            }
        }

        // Export Data Functions
        function openExportModal() {
            const modal = document.getElementById('exportModal');
            modal.classList.add('active');
            loadExportStats();
        }

        function closeExportModal() {
            const modal = document.getElementById('exportModal');
            modal.classList.remove('active');
        }

        // Close modal when clicking outside
        document.addEventListener('click', (e) => {
            const modal = document.getElementById('exportModal');
            if (e.target === modal) {
                closeExportModal();
            }
        });

        // Close modal with Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') {
                closeExportModal();
            }
        });

        // Load export statistics
        async function loadExportStats() {
            const countElement = document.getElementById('exportSubscriberCount');
            if (!countElement) return;

            countElement.textContent = '...';

            try {
                let count = 0;

                // Try to get count from newsletter manager
                if (typeof newsletterManager !== 'undefined') {
                    count = await newsletterManager.getSubscriberCount();
                } else {
                    // Fallback: fetch from JSONBin directly
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            },
                            cache: 'no-store'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            const subscribers = data.subscribers || [];
                            count = Array.isArray(subscribers) ? subscribers.length : (data.count || 0);
                        }
                    }

                    // Final fallback: local file
                    if (count === 0) {
                        const response = await fetch('/data/subscribers.json', {
                            cache: 'no-store'
                        });
                        if (response.ok) {
                            const data = await response.json();
                            count = Array.isArray(data) ? data.length : 0;
                        }
                    }
                }

                countElement.textContent = count.toLocaleString();
            } catch (error) {
                console.error('Error loading export stats:', error);
                countElement.textContent = 'Error';
            }
        }

        // Export subscribers in specified format
        async function exportSubscribers(format) {
            try {
                // Get subscribers
                let subscribers = [];

                if (typeof newsletterManager !== 'undefined') {
                    await newsletterManager.loadSubscribers();
                    subscribers = newsletterManager.subscribers || [];
                } else {
                    // Fallback: fetch from JSONBin directly
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            },
                            cache: 'no-store'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            subscribers = data.subscribers || [];
                        }
                    }

                    // Final fallback: local file
                    if (subscribers.length === 0) {
                        const response = await fetch('/data/subscribers.json', {
                            cache: 'no-store'
                        });
                        if (response.ok) {
                            subscribers = await response.json();
                        }
                    }
                }

                if (subscribers.length === 0) {
                    alert('‚ö†Ô∏è No subscribers to export.');
                    return;
                }

                let content, filename, mimeType;

                if (format === 'csv') {
                    // Create CSV content
                    const headers = ['Email', 'Export Date'];
                    const rows = subscribers.map(email => [email, new Date().toISOString()]);
                    const csvContent = [
                        headers.join(','),
                        ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
                    ].join('\n');

                    content = csvContent;
                    filename = `subscribers_${new Date().toISOString().split('T')[0]}.csv`;
                    mimeType = 'text/csv;charset=utf-8;';
                } else if (format === 'json') {
                    // Create JSON content with metadata
                    const exportData = {
                        exportDate: new Date().toISOString(),
                        totalSubscribers: subscribers.length,
                        subscribers: subscribers,
                        version: '1.0'
                    };

                    content = JSON.stringify(exportData, null, 2);
                    filename = `subscribers_${new Date().toISOString().split('T')[0]}.json`;
                    mimeType = 'application/json;charset=utf-8;';
                } else {
                    throw new Error('Invalid export format');
                }

                // Create download link
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                // Show success notification
                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = `‚úÖ Exported ${subscribers.length} subscribers as ${format.toUpperCase()}`;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);

            } catch (error) {
                console.error('Error exporting subscribers:', error);
                alert('‚ùå Failed to export subscribers: ' + error.message);
            }
        }

        // Export Data Functions
        function openExportModal() {
            const modal = document.getElementById('exportModal');
            modal.classList.add('active');
            loadExportStats();
        }

        function closeExportModal() {
            const modal = document.getElementById('exportModal');
            modal.classList.remove('active');
        }

        // Close export modal when clicking outside
        document.addEventListener('click', (e) => {
            const exportModal = document.getElementById('exportModal');
            if (e.target === exportModal) {
                closeExportModal();
            }
        });

        // Load export statistics
        async function loadExportStats() {
            const countElement = document.getElementById('exportSubscriberCount');
            if (!countElement) return;

            countElement.textContent = '...';

            try {
                let count = 0;

                // Try to get count from newsletter manager
                if (typeof newsletterManager !== 'undefined') {
                    count = await newsletterManager.getSubscriberCount();
                } else {
                    // Fallback: fetch from JSONBin directly
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            },
                            cache: 'no-store'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            const subscribers = data.subscribers || [];
                            count = Array.isArray(subscribers) ? subscribers.length : (data.count || 0);
                        }
                    }

                    // Final fallback: local file
                    if (count === 0) {
                        const response = await fetch('/data/subscribers.json', {
                            cache: 'no-store'
                        });
                        if (response.ok) {
                            const data = await response.json();
                            count = Array.isArray(data) ? data.length : 0;
                        }
                    }
                }

                countElement.textContent = count.toLocaleString();
            } catch (error) {
                console.error('Error loading export stats:', error);
                countElement.textContent = 'Error';
            }
        }

        // Export subscribers in specified format
        async function exportSubscribers(format) {
            try {
                // Get subscribers
                let subscribers = [];

                if (typeof newsletterManager !== 'undefined') {
                    await newsletterManager.loadSubscribers();
                    subscribers = newsletterManager.subscribers || [];
                } else {
                    // Fallback: fetch from JSONBin directly
                    const binId = localStorage.getItem('jsonbin_bin_id');
                    if (binId) {
                        const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                        const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                            headers: {
                                'X-Access-Key': accessKey
                            },
                            cache: 'no-store'
                        });

                        if (response.ok) {
                            const result = await response.json();
                            const data = result.record || result;
                            subscribers = data.subscribers || [];
                        }
                    }

                    // Final fallback: local file
                    if (subscribers.length === 0) {
                        const response = await fetch('/data/subscribers.json', {
                            cache: 'no-store'
                        });
                        if (response.ok) {
                            subscribers = await response.json();
                        }
                    }
                }

                if (subscribers.length === 0) {
                    alert('‚ö†Ô∏è No subscribers to export.');
                    return;
                }

                let content, filename, mimeType;

                if (format === 'csv') {
                    // Create CSV content
                    const headers = ['Email', 'Export Date'];
                    const rows = subscribers.map(email => [email, new Date().toISOString()]);
                    const csvContent = [
                        headers.join(','),
                        ...rows.map(row => row.map(cell => `"${cell}"`).join(','))
                    ].join('\n');

                    content = csvContent;
                    filename = `subscribers_${new Date().toISOString().split('T')[0]}.csv`;
                    mimeType = 'text/csv;charset=utf-8;';
                } else if (format === 'json') {
                    // Create JSON content with metadata
                    const exportData = {
                        exportDate: new Date().toISOString(),
                        totalSubscribers: subscribers.length,
                        subscribers: subscribers,
                        version: '1.0'
                    };

                    content = JSON.stringify(exportData, null, 2);
                    filename = `subscribers_${new Date().toISOString().split('T')[0]}.json`;
                    mimeType = 'application/json;charset=utf-8;';
                } else {
                    throw new Error('Invalid export format');
                }

                // Create download link
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = filename;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                // Show success notification
                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = `‚úÖ Exported ${subscribers.length} subscribers as ${format.toUpperCase()}`;
                document.body.appendChild(notification);

                setTimeout(() => {
                    notification.remove();
                }, 3000);

            } catch (error) {
                console.error('Error exporting subscribers:', error);
                alert('‚ùå Failed to export subscribers: ' + error.message);
            }
        }

        // App Management Functions
        let editingAppIndex = null;
        let apps = [];

        function openAppManager() {
            const modal = document.getElementById('appModal');
            modal.classList.add('active');
            loadApps();
        }

        function closeAppManager() {
            const modal = document.getElementById('appModal');
            modal.classList.remove('active');
        }

        function openAddAppForm() {
            editingAppIndex = null;
            document.getElementById('appFormTitle').textContent = '‚ûï Add New App';
            document.getElementById('appForm').reset();
            const modal = document.getElementById('appFormModal');
            modal.classList.add('active');
        }

        function openEditAppForm(index) {
            editingAppIndex = index;
            const app = apps[index];
            document.getElementById('appFormTitle').textContent = '‚úèÔ∏è Edit App';
            document.getElementById('appTitle').value = app.title;
            document.getElementById('appDesc').value = app.description;
            document.getElementById('appUrl').value = app.url;
            document.getElementById('appIcon').value = app.icon;
            const modal = document.getElementById('appFormModal');
            modal.classList.add('active');
        }

        function closeAppForm() {
            const modal = document.getElementById('appFormModal');
            modal.classList.remove('active');
            editingAppIndex = null;
        }

        // Close modals when clicking outside
        document.addEventListener('click', (e) => {
            const appModal = document.getElementById('appModal');
            const appFormModal = document.getElementById('appFormModal');
            if (e.target === appModal) closeAppManager();
            if (e.target === appFormModal) closeAppForm();
        });

        // Load apps from cloud storage
        async function loadApps() {
            const loadingState = document.getElementById('appLoadingState');
            const appList = document.getElementById('appList');
            const emptyState = document.getElementById('appEmptyState');
            const appStats = document.getElementById('appStats');
            const refreshBtn = document.getElementById('refreshAppsBtn');

            loadingState.classList.remove('hidden');
            appList.classList.add('hidden');
            emptyState.classList.add('hidden');
            appStats.classList.add('hidden');
            refreshBtn.disabled = true;
            refreshBtn.textContent = '‚è≥ Loading...';

            try {
                // Try to load from JSONBin (use public apps bin)
                const binId = localStorage.getItem('apps_bin_id') || '69670ee1d0ea881f406a814c'; // Public apps bin
                const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                
                const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                    headers: {
                        'X-Access-Key': accessKey
                    },
                    cache: 'no-store'
                });

                if (response.ok) {
                    const result = await response.json();
                    const data = result.record || result;
                    apps = data.apps || [];
                } else if (response.status === 404) {
                    // Bin doesn't exist yet, initialize with default apps
                    apps = getDefaultApps();
                    await saveApps();
                } else {
                    throw new Error(`Failed to load: ${response.status}`);
                }

                // Update stats
                document.getElementById('totalApps').textContent = apps.length.toLocaleString();
                appStats.classList.remove('hidden');
                appStats.style.display = 'flex';

                // Display apps
                if (apps.length === 0) {
                    loadingState.classList.add('hidden');
                    emptyState.classList.remove('hidden');
                } else {
                    displayApps();
                    loadingState.classList.add('hidden');
                    appList.classList.remove('hidden');
                }

            } catch (error) {
                console.error('Error loading apps:', error);
                // Fallback to default apps
                apps = getDefaultApps();
                displayApps();
                loadingState.classList.add('hidden');
                appList.classList.remove('hidden');
            } finally {
                refreshBtn.disabled = false;
                refreshBtn.textContent = 'üîÑ Refresh List';
            }
        }

        // Get default apps (from current index.html)
        function getDefaultApps() {
            return [
                {
                    title: 'Sudoku Mindscape - Basic',
                    description: 'Puzzle',
                    url: 'https://apps.apple.com/us/app/sudoku-mindscape/id6745157437',
                    icon: 'https://is1-ssl.mzstatic.com/image/thumb/Purple221/v4/8a/fe/d7/8afed7e5-ef74-5dcd-b430-1bcd35851d4d/AppIcon-0-0-1x_U007epad-0-1-85-220.png/540x540bb.jpg'
                },
                {
                    title: 'Sudoku Mindscape - Pro',
                    description: 'Puzzle',
                    url: 'https://apps.apple.com/us/app/sudoku-mindscape-pro/id6749170748',
                    icon: 'https://is1-ssl.mzstatic.com/image/thumb/Purple211/v4/d2/df/ab/d2dfab9b-25c0-8935-7579-e030ec38e241/AppIcon-0-0-1x_U007epad-0-1-85-220.png/540x540bb.jpg'
                },
                {
                    title: 'Hidden Secrets of Arkansas',
                    description: 'Travel',
                    url: 'https://apps.apple.com/us/app/hidden-secrets-of-arkansas/id1576165434',
                    icon: 'https://is1-ssl.mzstatic.com/image/thumb/Purple211/v4/ee/db/73/eedb73da-4212-a1ec-c4fd-e3bcd118b15b/AppIcon-0-1x_U007epad-0-7-0-sRGB-85-220-0.png/540x540bb.jpg'
                },
                {
                    title: 'Oliver\'s Whiteboard',
                    description: 'Education',
                    url: 'https://apps.apple.com/us/app/olivers-whiteboard/id1554030752',
                    icon: 'https://is1-ssl.mzstatic.com/image/thumb/Purple114/v4/3d/37/92/3d3792af-8fc8-7d64-a95d-60d6d616b796/AppIcon-0-1x_U007emarketing-0-7-0-sRGB-85-220.png/540x540bb.jpg'
                }
            ];
        }

        // Display apps in the list
        function displayApps() {
            const appList = document.getElementById('appList');
            appList.innerHTML = '';

            apps.forEach((app, index) => {
                const item = document.createElement('div');
                item.className = 'subscriber-item';
                item.innerHTML = `
                    <div class="app-item-content">
                        <img src="${app.icon}" alt="${app.title}" class="app-item-icon">
                        <div class="app-item-info">
                            <div class="app-item-title">${app.title}</div>
                            <div class="app-item-desc">${app.description}</div>
                            <a href="${app.url}" target="_blank" class="app-item-link">View on App Store ‚Üí</a>
                        </div>
                    </div>
                    <div class="subscriber-actions">
                        <button type="button" class="admin-btn btn-edit" onclick="openEditAppForm(${index})">
                            ‚úèÔ∏è Edit
                        </button>
                        <button type="button" class="btn-delete" onclick="deleteApp(${index})" title="Delete app">
                            üóëÔ∏è Delete
                        </button>
                    </div>
                `;
                appList.appendChild(item);
            });
        }

        // Save apps to cloud storage and local file
        async function saveApps() {
            try {
                // Use the public apps bin ID
                const binId = localStorage.getItem('apps_bin_id') || '69670ee1d0ea881f406a814c';
                const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                
                const data = {
                    apps: apps,
                    lastUpdated: new Date().toISOString(),
                    count: apps.length
                };

                // Save to JSONBin (public bin, but requires access key to write)
                const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}`, {
                    method: 'PUT',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-Access-Key': accessKey
                    },
                    body: JSON.stringify(data)
                });

                if (!response.ok) {
                    throw new Error(`Failed to update JSONBin: ${response.status}`);
                }

                // Store bin ID for future use
                localStorage.setItem('apps_bin_id', binId);

                // Also save to local file for public access (no auth needed)
                // Note: This requires server-side write capability or manual upload
                // For now, we'll download the file for manual upload
                const dataStr = JSON.stringify(data, null, 2);
                const dataBlob = new Blob([dataStr], { type: 'application/json' });
                const url = URL.createObjectURL(dataBlob);
                const link = document.createElement('a');
                link.href = url;
                link.download = 'apps.json';
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);

                console.log('‚úÖ Apps saved to cloud storage');
                console.log('üì• Apps file downloaded - please upload to /data/apps.json on your server');
                return true;
            } catch (error) {
                console.error('Error saving apps:', error);
                throw error;
            }
        }

        // Save app (from form)
        async function saveApp(event) {
            event.preventDefault();
            
            const title = document.getElementById('appTitle').value.trim();
            const description = document.getElementById('appDesc').value.trim();
            const url = document.getElementById('appUrl').value.trim();
            const icon = document.getElementById('appIcon').value.trim();

            if (!title || !description || !url || !icon) {
                alert('‚ùå Please fill in all fields.');
                return;
            }

            const app = { title, description, url, icon };

            try {
                if (editingAppIndex !== null) {
                    // Update existing app
                    apps[editingAppIndex] = app;
                } else {
                    // Add new app
                    apps.push(app);
                }

                await saveApps();
                await loadApps();
                closeAppForm();

                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = `‚úÖ App ${editingAppIndex !== null ? 'updated' : 'added'} successfully`;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);

            } catch (error) {
                console.error('Error saving app:', error);
                alert('‚ùå Failed to save app: ' + error.message);
            }
        }

        // Delete app
        async function deleteApp(index) {
            const app = apps[index];
            if (!confirm(`Are you sure you want to delete "${app.title}"?`)) {
                return;
            }

            try {
                apps.splice(index, 1);
                await saveApps();
                await loadApps();

                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = `‚úÖ "${app.title}" deleted successfully`;
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);

            } catch (error) {
                console.error('Error deleting app:', error);
                alert('‚ùå Failed to delete app: ' + error.message);
            }
        }

        // Analytics Dashboard Functions
        function openAnalytics() {
            const modal = document.getElementById('analyticsModal');
            modal.classList.add('active');
            loadAnalytics();
        }

        function closeAnalytics() {
            const modal = document.getElementById('analyticsModal');
            modal.classList.remove('active');
        }

        // Close analytics modal when clicking outside
        document.addEventListener('click', (e) => {
            const analyticsModal = document.getElementById('analyticsModal');
            if (e.target === analyticsModal) {
                closeAnalytics();
            }
        });

        // Load and display analytics
        async function loadAnalytics() {
            const refreshBtn = document.getElementById('refreshAnalyticsBtn');
            if (refreshBtn) {
                refreshBtn.disabled = true;
                refreshBtn.textContent = '‚è≥ Loading...';
            }

            try {
                // Load subscriber count
                let subscriberCount = 0;
                let historicalData = [];
                
                // Always try to fetch from JSONBin directly for analytics (more reliable)
                const binId = localStorage.getItem('jsonbin_bin_id') || '6967037143b1c97be92f1730';
                const accessKey = '$2a$10$.tte9gaAB5LnvRsH2dUz4OFuloHrp3GWDQsCdpRmgcfZ3uf4TYbsq';
                
                try {
                    console.log('üìä Fetching analytics data from JSONBin, bin ID:', binId);
                    const response = await fetch(`https://api.jsonbin.io/v3/b/${binId}/latest`, {
                        headers: { 'X-Access-Key': accessKey },
                        cache: 'no-store'
                    });
                    
                    if (response.ok) {
                        const result = await response.json();
                        console.log('üìä JSONBin response:', result);
                        const data = result.record || result;
                        
                        // Handle both old format (array) and new format (object)
                        if (Array.isArray(data)) {
                            subscriberCount = data.length;
                            historicalData = [];
                            console.log('üìä Old format detected, subscribers:', subscriberCount);
                        } else {
                            const subscribers = data.subscribers || [];
                            subscriberCount = Array.isArray(subscribers) ? subscribers.length : (data.count || 0);
                            historicalData = data.historicalData || [];
                            
                            console.log('üìä New format detected, subscribers array length:', subscribers.length, 'count field:', data.count);
                            console.log('üìä Historical data points:', historicalData.length);
                            
                            // Store in localStorage for quick access
                            if (historicalData.length > 0) {
                                localStorage.setItem('newsletter_historical_data', JSON.stringify(historicalData));
                            }
                        }
                        console.log('‚úÖ Loaded from JSONBin:', subscriberCount, 'subscribers,', historicalData.length, 'historical data points');
                    } else {
                        console.error('‚ùå JSONBin response not OK:', response.status, response.statusText);
                        const errorText = await response.text();
                        console.error('‚ùå Error details:', errorText);
                    }
                } catch (error) {
                    console.error('‚ùå Error fetching from JSONBin:', error);
                    // Fallback to newsletterManager if available
                    if (typeof newsletterManager !== 'undefined') {
                        try {
                            subscriberCount = await newsletterManager.getSubscriberCount();
                            historicalData = await newsletterManager.getHistoricalDataForChart(30);
                            console.log('‚úÖ Fallback to newsletterManager:', subscriberCount, 'subscribers');
                        } catch (fallbackError) {
                            console.error('‚ùå Fallback also failed:', fallbackError);
                        }
                    }
                }

                // Load app count
                let appCount = 0;
                const appsBinId = localStorage.getItem('apps_bin_id') || '69670ee1d0ea881f406a814c';
                try {
                    const appsResponse = await fetch(`https://api.jsonbin.io/v3/b/${appsBinId}/latest`, {
                        cache: 'no-store'
                    });
                    if (appsResponse.ok) {
                        const appsResult = await appsResponse.json();
                        const appsData = appsResult.record || appsResult;
                        const apps = appsData.apps || [];
                        appCount = apps.length;
                    }
                } catch (e) {
                    console.log('Could not load app count:', e);
                }

                // Update stats
                document.getElementById('totalSubscribersStat').textContent = subscriberCount.toLocaleString();
                document.getElementById('totalAppsStat').textContent = appCount.toLocaleString();
                
                // Calculate growth rate (simplified - would need historical data for real calculation)
                const growthRate = subscriberCount > 0 ? '+12%' : '0%';
                document.getElementById('growthRateStat').textContent = growthRate;
                
                // Newsletter sends count
                let newsletterSends = 0;
                try {
                    if (typeof newsletterManager !== 'undefined') {
                        newsletterSends = await newsletterManager.getNewsletterSendsCount();
                    } else {
                        // Fallback to localStorage
                        const storedSends = localStorage.getItem('newsletter_sends_count');
                        newsletterSends = parseInt(storedSends, 10) || 0;
                    }
                } catch (error) {
                    console.error('Error loading newsletter sends count:', error);
                    const storedSends = localStorage.getItem('newsletter_sends_count');
                    newsletterSends = parseInt(storedSends, 10) || 0;
                }
                document.getElementById('newsletterSendsStat').textContent = newsletterSends.toLocaleString();

                // Create simple subscriber growth chart with real historical data
                await createSimpleChart(subscriberCount, historicalData);

            } catch (error) {
                console.error('Error loading analytics:', error);
            } finally {
                if (refreshBtn) {
                    refreshBtn.disabled = false;
                    refreshBtn.textContent = 'üîÑ Refresh Analytics';
                }
            }
        }

        // Create a simple chart visualization using real historical data
        async function createSimpleChart(currentCount, providedHistoricalData = null) {
            const chartContainer = document.getElementById('subscriberGrowthChart');
            if (!chartContainer) {
                console.error('Chart container not found');
                return;
            }

            console.log('Creating chart with subscriber count:', currentCount);

            // Use provided historical data, or fetch it
            let historicalData = providedHistoricalData || [];
            
            if (historicalData.length === 0) {
                // Try to get from localStorage
                try {
                    const stored = localStorage.getItem('newsletter_historical_data');
                    if (stored) {
                        const allData = JSON.parse(stored);
                        const cutoffDate = new Date();
                        cutoffDate.setDate(cutoffDate.getDate() - 30);
                        historicalData = allData.filter(s => new Date(s.date) >= cutoffDate)
                            .sort((a, b) => new Date(a.date) - new Date(b.date));
                    }
                } catch (error) {
                    console.error('Error loading historical data from localStorage:', error);
                }
            }
            
            // If still no data and newsletterManager is available, try to get fresh data
            if (historicalData.length === 0 && typeof newsletterManager !== 'undefined') {
                try {
                    const freshData = await newsletterManager.getHistoricalDataForChart(30);
                    if (freshData && freshData.length > 0) {
                        historicalData = freshData;
                    }
                } catch (error) {
                    console.warn('Could not fetch fresh historical data:', error);
                }
            }

            console.log('Historical data points:', historicalData.length);

            // Generate data points for last 30 days
            const days = 30;
            const dataPoints = [];
            const today = new Date();
            
            // Create a map of historical data by date for quick lookup
            const historicalMap = {};
            historicalData.forEach(item => {
                historicalMap[item.date] = item.count;
            });

            // Fill in data for each of the last 30 days
            for (let i = days - 1; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(date.getDate() - i);
                const dateStr = date.toISOString().split('T')[0];
                
                if (historicalMap[dateStr] !== undefined) {
                    // Use real historical data
                    dataPoints.push(historicalMap[dateStr]);
                } else {
                    // For days without data, use the previous day's count or 0
                    const prevIndex = dataPoints.length - 1;
                    const prevValue = prevIndex >= 0 ? dataPoints[prevIndex] : 0;
                    dataPoints.push(prevValue);
                }
            }

            // Ensure we have today's count
            if (dataPoints.length > 0) {
                dataPoints[dataPoints.length - 1] = currentCount;
            }

            // Create a simple bar chart using divs
            chartContainer.innerHTML = '';
            chartContainer.className = 'simple-chart';
            const maxValue = Math.max(...dataPoints, 1);
            
            console.log('Max value:', maxValue, 'Data points:', dataPoints.length);
            
            if (maxValue === 0 || currentCount === 0) {
                // Show empty state with a message
                chartContainer.innerHTML = '';
                chartContainer.className = '';
                const emptyMsg = document.createElement('div');
                emptyMsg.className = 'analytics-empty';
                emptyMsg.innerHTML = '<div class="analytics-empty-icon">üìä</div><p>No subscriber data yet</p><p class="analytics-empty-subtext">Start collecting subscribers to see growth trends</p>';
                chartContainer.appendChild(emptyMsg);
                return;
            }
            
            dataPoints.forEach((value, index) => {
                const bar = document.createElement('div');
                const height = maxValue > 0 ? Math.max(2, (value / maxValue) * 100) : 2; // Minimum 2% height for visibility
                bar.className = 'simple-chart-bar';
                bar.style.height = `${height}%`;
                
                // Calculate the date for this bar
                const barDate = new Date(today);
                barDate.setDate(barDate.getDate() - (days - 1 - index));
                const dateStr = barDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric' });
                
                bar.title = `${dateStr}: ${value} subscriber${value !== 1 ? 's' : ''}`;
                chartContainer.appendChild(bar);
            });
            
            console.log('Chart created with', dataPoints.length, 'bars using real historical data');
        }

        // Settings Management Functions
        function openSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.add('active');
            
            // Wait for newsletterManager to be available (with retry)
            let attempts = 0;
            const maxAttempts = 10;
            const checkAndLoad = () => {
                attempts++;
                if (typeof newsletterManager !== 'undefined' || attempts >= maxAttempts) {
                    loadSettings();
                } else {
                    setTimeout(checkAndLoad, 100);
                }
            };
            checkAndLoad();
        }

        function closeSettings() {
            const modal = document.getElementById('settingsModal');
            modal.classList.remove('active');
        }

        function switchSettingsTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.settings-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.settings-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`settings${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.add('active');
            event.target.classList.add('active');
        }

        // Load current settings
        function loadSettings() {
            // Helper function to safely get value from newsletterManager
            const getManagerValue = (key) => {
                if (typeof newsletterManager !== 'undefined' && newsletterManager[key]) {
                    return newsletterManager[key];
                }
                return '';
            };

            // Load JSONBin settings (prioritize localStorage, then newsletterManager, then defaults)
            const storedAccessKey = localStorage.getItem('jsonbin_access_key');
            const managerAccessKey = getManagerValue('jsonBinAccessKey');
            document.getElementById('jsonbinAccessKey').value = storedAccessKey || managerAccessKey || '';

            const storedBinId = localStorage.getItem('jsonbin_bin_id');
            const managerBinId = getManagerValue('jsonBinBinId');
            document.getElementById('jsonbinBinId').value = storedBinId || managerBinId || '';

            document.getElementById('jsonbinAppsBinId').value = localStorage.getItem('apps_bin_id') || '69670ee1d0ea881f406a814c';

            // Load EmailJS settings (prioritize localStorage, then newsletterManager)
            const storedServiceId = localStorage.getItem('emailjs_service_id');
            const managerServiceId = getManagerValue('serviceId');
            document.getElementById('emailjsServiceId').value = storedServiceId || managerServiceId || '';

            const storedTemplateId = localStorage.getItem('emailjs_template_id');
            const managerTemplateId = getManagerValue('templateId');
            document.getElementById('emailjsTemplateId').value = storedTemplateId || managerTemplateId || '';

            document.getElementById('emailjsNewsletterTemplateId').value = localStorage.getItem('emailjs_newsletter_template_id') || '';

            const storedUserId = localStorage.getItem('emailjs_user_id');
            const managerUserId = getManagerValue('userId');
            document.getElementById('emailjsUserId').value = storedUserId || managerUserId || '';

            // Load website preferences
            // Get description from localStorage, or use the default from index.html
            // (Don't use admin.html's meta tag as it's different)
            const defaultDescription = 'Irie Development creates innovative iOS apps for iPhone, iPad, and Apple Watch, including Sudoku Mindscape and Hidden Secrets of Arkansas. Based in Arkansas.';
            document.getElementById('websiteName').value = localStorage.getItem('website_name') || 'Irie Development';
            document.getElementById('websiteDescription').value = localStorage.getItem('website_description') || defaultDescription;

            // Debug: Log what we loaded
            console.log('üìã Settings loaded:', {
                jsonbinAccessKey: document.getElementById('jsonbinAccessKey').value ? '***' : 'empty',
                jsonbinBinId: document.getElementById('jsonbinBinId').value || 'empty',
                emailjsServiceId: document.getElementById('emailjsServiceId').value || 'empty',
                emailjsTemplateId: document.getElementById('emailjsTemplateId').value || 'empty',
                emailjsUserId: document.getElementById('emailjsUserId').value || 'empty',
                newsletterManagerExists: typeof newsletterManager !== 'undefined',
                managerHasValues: typeof newsletterManager !== 'undefined' ? {
                    serviceId: !!newsletterManager.serviceId,
                    templateId: !!newsletterManager.templateId,
                    userId: !!newsletterManager.userId,
                    jsonBinAccessKey: !!newsletterManager.jsonBinAccessKey,
                    jsonBinBinId: !!newsletterManager.jsonBinBinId
                } : 'N/A'
            });
        }

        // Save settings
        async function saveSettings() {
            try {
                // Save JSONBin settings (note: these are sensitive, handle carefully)
                const accessKey = document.getElementById('jsonbinAccessKey').value.trim();
                const binId = document.getElementById('jsonbinBinId').value.trim();
                const appsBinId = document.getElementById('jsonbinAppsBinId').value.trim();

                // Save access key to localStorage (for persistence across page reloads)
                if (accessKey) {
                    localStorage.setItem('jsonbin_access_key', accessKey);
                } else {
                    localStorage.removeItem('jsonbin_access_key');
                }

                // Update newsletterManager instance if it exists
                if (typeof newsletterManager !== 'undefined') {
                    if (accessKey) {
                        newsletterManager.jsonBinAccessKey = accessKey;
                    }
                    if (binId) {
                        newsletterManager.jsonBinBinId = binId;
                    }
                }

                // Save bin IDs (always save, even if empty, to allow clearing)
                localStorage.setItem('jsonbin_bin_id', binId || '');
                localStorage.setItem('apps_bin_id', appsBinId || '');

                // Save EmailJS settings
                const serviceId = document.getElementById('emailjsServiceId').value.trim();
                const templateId = document.getElementById('emailjsTemplateId').value.trim();
                const newsletterTemplateId = document.getElementById('emailjsNewsletterTemplateId').value.trim();
                const userId = document.getElementById('emailjsUserId').value.trim();

                // Update newsletterManager instance if it exists
                if (typeof newsletterManager !== 'undefined') {
                    if (serviceId) newsletterManager.serviceId = serviceId;
                    if (templateId) newsletterManager.templateId = templateId;
                    if (userId) newsletterManager.userId = userId;
                }

                // Save EmailJS settings to localStorage (always save, even if empty)
                localStorage.setItem('emailjs_service_id', serviceId || '');
                localStorage.setItem('emailjs_template_id', templateId || '');
                localStorage.setItem('emailjs_newsletter_template_id', newsletterTemplateId || '');
                localStorage.setItem('emailjs_user_id', userId || '');

                // Save website preferences (always save, even if empty)
                localStorage.setItem('website_name', document.getElementById('websiteName').value || '');
                localStorage.setItem('website_description', document.getElementById('websiteDescription').value || '');

                // Show success notification
                const notification = document.createElement('div');
                notification.className = 'notification-success';
                notification.textContent = '‚úÖ Settings saved successfully!';
                document.body.appendChild(notification);
                setTimeout(() => notification.remove(), 3000);

                console.log('‚úÖ Settings saved');
            } catch (error) {
                console.error('Error saving settings:', error);
                alert('‚ùå Failed to save settings: ' + error.message);
            }
        }

        // Toggle password visibility
        function togglePasswordVisibility(inputId, button) {
            const input = document.getElementById(inputId);
            if (input.type === 'password') {
                input.type = 'text';
                button.textContent = 'üôà';
            } else {
                input.type = 'password';
                button.textContent = 'üëÅÔ∏è';
            }
        }

        // Test JSONBin connection
        async function testJSONBinConnection() {
            const accessKey = document.getElementById('jsonbinAccessKey').value.trim();
            const binId = document.getElementById('jsonbinBinId').value.trim() || localStorage.getItem('jsonbin_bin_id');

            if (!accessKey) {
                alert('‚ùå Please enter an Access Key first');
                return;
            }

            const testBtn = event.target;
            const originalText = testBtn.textContent;
            testBtn.disabled = true;
            testBtn.textContent = '‚è≥ Testing...';

            try {
                const url = binId 
                    ? `https://api.jsonbin.io/v3/b/${binId}/latest`
                    : 'https://api.jsonbin.io/v3/b';
                
                const response = await fetch(url, {
                    headers: {
                        'X-Access-Key': accessKey
                    }
                });

                if (response.ok || response.status === 404) {
                    alert('‚úÖ Connection successful! JSONBin API key is valid.');
                } else {
                    const error = await response.text();
                    alert(`‚ùå Connection failed: ${response.status} - ${error}`);
                }
            } catch (error) {
                alert('‚ùå Connection failed: ' + error.message);
            } finally {
                testBtn.disabled = false;
                testBtn.textContent = originalText;
            }
        }

        // Export settings
        function exportSettings() {
            const settings = {
                jsonbin: {
                    accessKey: document.getElementById('jsonbinAccessKey').value,
                    binId: document.getElementById('jsonbinBinId').value,
                    appsBinId: document.getElementById('jsonbinAppsBinId').value
                },
                emailjs: {
                    serviceId: document.getElementById('emailjsServiceId').value,
                    templateId: document.getElementById('emailjsTemplateId').value,
                    newsletterTemplateId: document.getElementById('emailjsNewsletterTemplateId').value,
                    userId: document.getElementById('emailjsUserId').value
                },
                website: {
                    name: document.getElementById('websiteName').value,
                    description: document.getElementById('websiteDescription').value
                },
                exportDate: new Date().toISOString()
            };

            const dataStr = JSON.stringify(settings, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `iriedevelopment-settings-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);

            alert('‚úÖ Settings exported successfully!');
        }

        // Import settings
        function importSettings(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = (e) => {
                try {
                    const settings = JSON.parse(e.target.result);
                    
                    // Import JSONBin settings
                    if (settings.jsonbin) {
                        if (settings.jsonbin.accessKey) document.getElementById('jsonbinAccessKey').value = settings.jsonbin.accessKey;
                        if (settings.jsonbin.binId) document.getElementById('jsonbinBinId').value = settings.jsonbin.binId;
                        if (settings.jsonbin.appsBinId) document.getElementById('jsonbinAppsBinId').value = settings.jsonbin.appsBinId;
                    }

                    // Import EmailJS settings
                    if (settings.emailjs) {
                        if (settings.emailjs.serviceId) document.getElementById('emailjsServiceId').value = settings.emailjs.serviceId;
                        if (settings.emailjs.templateId) document.getElementById('emailjsTemplateId').value = settings.emailjs.templateId;
                        if (settings.emailjs.newsletterTemplateId) document.getElementById('emailjsNewsletterTemplateId').value = settings.emailjs.newsletterTemplateId;
                        if (settings.emailjs.userId) document.getElementById('emailjsUserId').value = settings.emailjs.userId;
                    }

                    // Import website settings
                    if (settings.website) {
                        if (settings.website.name) document.getElementById('websiteName').value = settings.website.name;
                        if (settings.website.description) document.getElementById('websiteDescription').value = settings.website.description;
                    }

                    alert('‚úÖ Settings imported successfully! Click "Save Settings" to apply.');
                } catch (error) {
                    alert('‚ùå Failed to import settings: ' + error.message);
                }
            };
            reader.readAsText(file);
        }

        // Clear all data (dangerous!)
        async function clearAllData() {
            if (!confirm('‚ö†Ô∏è WARNING: This will delete ALL subscribers, apps, and settings!\n\nThis action CANNOT be undone.\n\nAre you absolutely sure?')) {
                return;
            }

            if (!confirm('‚ö†Ô∏è Final confirmation: Delete EVERYTHING?')) {
                return;
            }

            try {
                // Clear subscribers if newsletterManager exists
                if (typeof newsletterManager !== 'undefined') {
                    await newsletterManager.clearSubscribers();
                }

                // Clear apps (if apps array exists in scope)
                if (typeof apps !== 'undefined' && Array.isArray(apps)) {
                    apps = [];
                    await saveApps();
                }

                // Clear localStorage (this will clear settings and other cached data)
                localStorage.clear();

                alert('‚úÖ All data cleared. Page will reload.');
                location.reload();
            } catch (error) {
                console.error('Error clearing data:', error);
                alert('‚ùå Error clearing data: ' + error.message);
            }
        }

        // Close settings modal when clicking outside
        document.addEventListener('click', (e) => {
            const settingsModal = document.getElementById('settingsModal');
            if (e.target === settingsModal) {
                closeSettings();
            }
        });

        // Content Editor Functions
        function openContentEditor() {
            const modal = document.getElementById('contentEditorModal');
            modal.classList.add('active');
            loadContentEditor();
        }

        function closeContentEditor() {
            const modal = document.getElementById('contentEditorModal');
            modal.classList.remove('active');
        }

        function switchContentTab(tabName) {
            // Hide all tabs
            document.querySelectorAll('.content-editor-tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            document.querySelectorAll('.content-editor-tab').forEach(btn => {
                btn.classList.remove('active');
            });

            // Show selected tab
            document.getElementById(`content${tabName.charAt(0).toUpperCase() + tabName.slice(1)}Tab`).classList.add('active');
            event.target.classList.add('active');
        }

        // Load current content
        function loadContentEditor() {
            // Load SEO settings from localStorage or fetch from current page
            document.getElementById('seoPageTitle').value = localStorage.getItem('seo_page_title') || 'Irie Development | iOS App Developer & Arkansas Apps';
            document.getElementById('seoMetaDescription').value = localStorage.getItem('seo_meta_description') || 'Irie Development creates innovative iOS apps for iPhone, iPad, and Apple Watch, including Sudoku Mindscape and Hidden Secrets of Arkansas. Based in Arkansas.';
            document.getElementById('seoKeywords').value = localStorage.getItem('seo_keywords') || 'iOS developer, iPhone apps, iPad apps, Apple Watch apps, Arkansas apps, Sudoku Mindscape, Hidden Secrets of Arkansas, mobile app development, iOS programming';
            document.getElementById('seoOgTitle').value = localStorage.getItem('seo_og_title') || 'Irie Development | iOS App Developer & Arkansas Apps';
            document.getElementById('seoOgDescription').value = localStorage.getItem('seo_og_description') || 'Innovative iOS apps for iPhone, iPad, and Apple Watch. Discover Sudoku Mindscape, Hidden Secrets of Arkansas, and more!';
            document.getElementById('seoOgImage').value = localStorage.getItem('seo_og_image') || 'https://iriedevelopment.com/og-image.jpg';
            document.getElementById('seoTwitterTitle').value = localStorage.getItem('seo_twitter_title') || 'Irie Development | iOS App Developer & Arkansas Apps';
            document.getElementById('seoTwitterDescription').value = localStorage.getItem('seo_twitter_description') || 'Innovative iOS apps for iPhone, iPad, and Apple Watch. Discover Sudoku Mindscape, Hidden Secrets of Arkansas, and more!';

            // Load page content
            document.getElementById('contentMainHeading').value = localStorage.getItem('content_main_heading') || '';
            document.getElementById('contentAboutText').value = localStorage.getItem('content_about_text') || '';
            document.getElementById('contentNewsletterText').value = localStorage.getItem('content_newsletter_text') || '';
        }

        // Load page content based on selection
        function loadPageContent() {
            const pageSelect = document.getElementById('contentPageSelect');
            const selectedPage = pageSelect.value;
            console.log('Loading content for:', selectedPage);
            // For now, just load from localStorage
            // In a full implementation, you'd fetch the actual page content
        }

        // Export content changes as HTML snippets or instructions
        function exportContentChanges() {
            const changes = {
                seo: {
                    pageTitle: document.getElementById('seoPageTitle').value,
                    metaDescription: document.getElementById('seoMetaDescription').value,
                    keywords: document.getElementById('seoKeywords').value,
                    ogTitle: document.getElementById('seoOgTitle').value,
                    ogDescription: document.getElementById('seoOgDescription').value,
                    ogImage: document.getElementById('seoOgImage').value,
                    twitterTitle: document.getElementById('seoTwitterTitle').value,
                    twitterDescription: document.getElementById('seoTwitterDescription').value
                },
                content: {
                    mainHeading: document.getElementById('contentMainHeading').value,
                    aboutText: document.getElementById('contentAboutText').value,
                    newsletterText: document.getElementById('contentNewsletterText').value
                },
                exportDate: new Date().toISOString(),
                instructions: 'Copy these values and update your HTML files manually, or use this as a reference for changes needed.'
            };

            // Save to localStorage
            localStorage.setItem('seo_page_title', changes.seo.pageTitle);
            localStorage.setItem('seo_meta_description', changes.seo.metaDescription);
            localStorage.setItem('seo_keywords', changes.seo.keywords);
            localStorage.setItem('seo_og_title', changes.seo.ogTitle);
            localStorage.setItem('seo_og_description', changes.seo.ogDescription);
            localStorage.setItem('seo_og_image', changes.seo.ogImage);
            localStorage.setItem('seo_twitter_title', changes.seo.twitterTitle);
            localStorage.setItem('seo_twitter_description', changes.seo.twitterDescription);
            localStorage.setItem('content_main_heading', changes.content.mainHeading);
            localStorage.setItem('content_about_text', changes.content.aboutText);
            localStorage.setItem('content_newsletter_text', changes.content.newsletterText);

            // Generate HTML snippets
            const htmlSnippets = generateHTMLSnippets(changes);

            // Create downloadable file
            const dataStr = JSON.stringify({ changes, htmlSnippets }, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const link = document.createElement('a');
            link.href = url;
            link.download = `content-changes-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            URL.revokeObjectURL(url);

            // Show success notification
            const notification = document.createElement('div');
            notification.className = 'notification-success';
            notification.textContent = '‚úÖ Content changes exported! Check the downloaded file for HTML snippets to update your pages.';
            document.body.appendChild(notification);
            setTimeout(() => notification.remove(), 5000);

            alert('‚úÖ Content changes exported!\n\nA JSON file has been downloaded with:\n- All your content changes\n- HTML snippets ready to copy\n\nNote: For a static site, you\'ll need to manually update your HTML files with these changes.');
        }

        // Generate HTML snippets from changes
        function generateHTMLSnippets(changes) {
            return {
                headSnippet: `<!-- SEO Meta Tags -->
  <title>${escapeHtml(changes.seo.pageTitle)}</title>
  <meta name="description" content="${escapeHtml(changes.seo.metaDescription)}">
  <meta name="keywords" content="${escapeHtml(changes.seo.keywords)}">
  <!-- Open Graph / Facebook -->
  <meta property="og:title" content="${escapeHtml(changes.seo.ogTitle)}">
  <meta property="og:description" content="${escapeHtml(changes.seo.ogDescription)}">
  <meta property="og:image" content="${escapeHtml(changes.seo.ogImage)}">
  <!-- Twitter -->
  <meta property="twitter:title" content="${escapeHtml(changes.seo.twitterTitle)}">
  <meta property="twitter:description" content="${escapeHtml(changes.seo.twitterDescription)}">`,
                contentSnippet: changes.content.mainHeading ? `<h1>${escapeHtml(changes.content.mainHeading)}</h1>` : '',
                aboutSnippet: changes.content.aboutText ? `<div class="about">${escapeHtml(changes.content.aboutText).replace(/\n/g, '<br>')}</div>` : '',
                newsletterSnippet: changes.content.newsletterText ? `<p>${escapeHtml(changes.content.newsletterText).replace(/\n/g, '<br>')}</p>` : ''
            };
        }

        // Escape HTML to prevent XSS
        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        // Close content editor modal when clicking outside
        document.addEventListener('click', (e) => {
            const contentEditorModal = document.getElementById('contentEditorModal');
            if (e.target === contentEditorModal) {
                closeContentEditor();
            }
        });

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            checkGitHubAuth();
        });
    </script>
    <!-- Serverless API Configuration -->
    <script>
      window.SERVERLESS_API_URL = 'https://irie-development.vercel.app/api';
    </script>
    <script src="newsletter-serverless.js"></script>
</body>
</html> 